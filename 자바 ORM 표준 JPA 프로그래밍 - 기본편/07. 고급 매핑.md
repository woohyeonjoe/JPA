# ê³ ê¸‰ ë§¤í•‘

## ìƒì†ê´€ê³„ ë§¤í•‘

<aside>
ğŸ’¡ ì˜¤ë¥˜(ìƒì† ê´€ê³„ ê°ì²´ ë§¤í•‘ì‹œ ë‘ë²ˆì§¸ ì‹¤í–‰ë¶€í„° í…Œì´ë¸”ì´ ë“œë¡­ ë˜ì§€ì•ŠëŠ” ë²„ê·¸) ë°œìƒì‹œ ì°¸ê³ 

[https://www.inflearn.com/questions/52796](https://www.inflearn.com/questions/52796)

</aside>

**ìƒì†ê´€ê³„ ë§¤í•‘**

- ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìƒì† ê´€ê³„X
- ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ê´€ê³„ë¼ëŠ” ëª¨ë¸ë§ ê¸°ë²•ì´ ê°ì²´ ìƒì†ê³¼ ìœ ì‚¬
- ìƒì†ê´€ê³„ ë§¤í•‘: ê°ì²´ì˜ ìƒì†ê³¼ êµ¬ì¡°ì™€ DBì˜ ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ê´€ê³„ë¥¼ ë§¤í•‘
- ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ë…¼ë¦¬ ëª¨ë¸ì„ ì‹¤ì œ ë¬¼ë¦¬ ëª¨ë¸ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²•
    - ê°ê° í…Œì´ë¸”ë¡œ ë³€í™˜ -> ì¡°ì¸ ì „ëµ
    - í†µí•© í…Œì´ë¸”ë¡œ ë³€í™˜ -> ë‹¨ì¼ í…Œì´ë¸” ì „ëµ
    - ì„œë¸Œíƒ€ì… í…Œì´ë¸”ë¡œ ë³€í™˜ -> êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ
- @Inheritance([strategy=InheritanceType.XXX](http://strategy%3Dinheritancetype.xxx/))
    - JOINED: ì¡°ì¸ ì „ëµ
    - SINGLE_TABLE: ë‹¨ì¼ í…Œì´ë¸” ì „ëµ
    - TABLE_PER_CLASS: êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ
- @DiscriminatorColumn(name=â€œDTYPEâ€)
    - ê¶Œì¥, (ì–´ë–¤ í…Œì´ë¸”ì˜ ë°ì´í„°ì¸ì§€ í•œëˆˆì— í™•ì¸ ê°€ëŠ¥)
- @DiscriminatorValue(â€œXXXâ€)

**ì¡°ì¸ì „ëµ**

![image](https://user-images.githubusercontent.com/106286686/215438598-3caf5bd0-6c6e-43af-981b-a6c5ddc23a7a.png)

- ì¥ì 
    - í…Œì´ë¸” ì •ê·œí™”
    - ì™¸ë˜ í‚¤ ì°¸ì¡° ë¬´ê²°ì„± ì œì•½ì¡°ê±´ í™œìš©ê°€ëŠ¥
    - ì €ì¥ê³µê°„ íš¨ìœ¨í™”
- ë‹¨ì 
    - ì¡°íšŒì‹œ ì¡°ì¸ì„ ë§ì´ ì‚¬ìš©, ì„±ëŠ¥ ì €í•˜
    - ì¡°íšŒ ì¿¼ë¦¬ê°€ ë³µì¡í•¨
    - ë°ì´í„° ì €ì¥ì‹œ INSERT SQL 2ë²ˆ í˜¸ì¶œ

**ë‹¨ì¼ í…Œì´ë¸” ì „ëµ**

![image](https://user-images.githubusercontent.com/106286686/215438710-a62cc54f-7c26-40b8-a1bd-4524ef15ac39.png)

- ì¥ì 
    - ì¡°ì¸ì´ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ì¼ë°˜ì ìœ¼ë¡œ ì¡°íšŒ ì„±ëŠ¥ì´ ë¹ ë¦„
    - ì¡°íšŒ ì¿¼ë¦¬ê°€ ë‹¨ìˆœí•¨
- ë‹¨ì 
    - ìì‹ ì—”í‹°í‹°ê°€ ë§¤í•‘í•œ ì»¬ëŸ¼ì€ ëª¨ë‘ null í—ˆìš©
    - ë‹¨ì¼ í…Œì´ë¸”ì— ëª¨ë“  ê²ƒì„ ì €ì¥í•˜ë¯€ë¡œ í…Œì´ë¸”ì´ ì»¤ì§ˆ ìˆ˜ ìˆë‹¤. ìƒí™©ì— ë”°ë¼ì„œ ì¡°íšŒ ì„±ëŠ¥ì´ ì˜¤íˆë ¤ ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤.

**@DiscriminatorColumn ìƒëµí•´ë„ DTYPE ê°•ì œë¡œ ë“¤ì–´ê°€ì§**

**êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ**

![image](https://user-images.githubusercontent.com/106286686/215438798-f66d8ed7-f09b-4573-a78c-8ac0ac1e8330.png)

- **ì´ ì „ëµì€ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ìì™€ ORM ì „ë¬¸ê°€ ë‘˜ ë‹¤ ì¶”ì²œX**
- ì¥ì 
    - ì„œë¸Œ íƒ€ì…ì„ ëª…í™•í•˜ê²Œ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬í•  ë•Œ íš¨ê³¼ì 
    - not null ì œì•½ì¡°ê±´ ì‚¬ìš© ê°€ëŠ¥
- ë‹¨ì 
    - ì—¬ëŸ¬ ìì‹ í…Œì´ë¸”ì„ í•¨ê»˜ ì¡°íšŒí•  ë•Œ ì„±ëŠ¥ì´ ëŠë¦¼(UNION SQL í•„ìš”)
    - ìì‹ í…Œì´ë¸”ì„ í†µí•©í•´ì„œ ì¿¼ë¦¬í•˜ê¸° ì–´ë ¤ì›€

## Mapped Superclass - ë§¤í•‘ ì •ë³´ ìƒì†

**@MappedSuperclass**

- ìƒì†ê´€ê³„ ë§¤í•‘X
- ì—”í‹°í‹°X, í…Œì´ë¸”ê³¼ ë§¤í•‘X
- ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ëŠ” ìì‹ í´ë˜ìŠ¤ì— ë§¤í•‘ ì •ë³´ë§Œ ì œê³µ
- ì¡°íšŒ, ê²€ìƒ‰ ë¶ˆê°€(em.find(BaseEntity) ë¶ˆê°€)
- ì§ì ‘ ìƒì„±í•´ì„œ ì‚¬ìš©í•  ì¼ì´ ì—†ìœ¼ë¯€ë¡œ ì¶”ìƒ í´ë˜ìŠ¤(abstract) ê¶Œì¥
- í…Œì´ë¸”ê³¼ ê´€ê³„ ì—†ê³ , ë‹¨ìˆœíˆ ì—”í‹°í‹°ê°€ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë§¤í•‘ ì •ë³´ë¥¼ ëª¨ìœ¼ëŠ” ì—­í• 
- ì£¼ë¡œ ë“±ë¡ì¼, ìˆ˜ì •ì¼, ë“±ë¡ì, ìˆ˜ì •ì ê°™ì€ ì „ì²´ ì—”í‹°í‹°ì—ì„œ ê³µí†µìœ¼ë¡œ ì ìš©í•˜ëŠ” ì •ë³´ë¥¼ ëª¨ì„ ë•Œ ì‚¬ìš©
- ì°¸ê³ : @Entity í´ë˜ìŠ¤ëŠ” ì—”í‹°í‹°ë‚˜ @MappedSuperclassë¡œ ì§€ì •í•œ í´ë˜ìŠ¤ë§Œ ìƒì† ê°€ëŠ¥

## ì‹¤ì „ ì˜ˆì œ4 - ìƒì†ê´€ê³„ ë§¤í•‘

**ë„ë©”ì¸ ëª¨ë¸, ë„ë©”ì¸ ëª¨ë¸ ìƒì„¸, í…Œì´ë¸” ì„¤ê³„**
ê°•ì˜ìë£Œ ì°¸ê³ 

**Item**

```java
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn
public abstract class Item {

    @Id @GeneratedValue
    @Column(name = "ITEM_ID")
    private Long id;

    private String name;

    private int price;

    private int stockQuantity;

    @ManyToMany(mappedBy = "items")
    private List<Category> categories = new ArrayList<>();
}
```

**ì „ëµì„ ì†ì‰½ê²Œ ë³€ê²½ ê°€ëŠ¥í•˜ë‹¤.**

**Album**

```java
@Entity
public class Album extends Item{

    private String artist;
    private String etc;

    public String getArtist() {
        return artist;
    }

    public void setArtist(String artist) {
        this.artist = artist;
    }

    public String getEtc() {
        return etc;
    }

    public void setEtc(String etc) {
        this.etc = etc;
    }
}
```

**Movie, Book ìƒëµ**

**@MappedSuperclassë¥¼ ì´ìš©í•œ ê³µí†µ ì¹¼ëŸ¼ ì²˜ë¦¬**

```java
@MappedSuperclass
public abstract class BaseEntity {

    @Column(name = "INSERT_MEMBER")
    private String createdBy;
    private LocalDateTime createDate;
    @Column(name = "UPDATE_MEMBER")
    private String lastModifiedBy;
    private LocalDateTime lastModifiedDate;
}
```

**ìƒì†ë§Œ í•´ì£¼ë©´ ëœë‹¤.**

```java
@Entity
public class Member extends BaseEntity{}
```
